with player_salaries as (
    SELECT 
        CASE
            WHEN LOWER(player) = 'aleksandar pavlovic' THEN 'sashapavlovic'
            WHEN LOWER(player) = 'bj mullens' THEN 'byronmullens'
            WHEN LOWER(player) = 'dennis smith' THEN 'dennissmithjr'
            WHEN LOWER(player) = 'dennis schroeder' THEN 'dennisschroder'
            WHEN LOWER(player) = 'clarence weatherspoon' THEN 'clarweatherspoon'
            WHEN LOWER(player) = 'danny schayes' THEN 'danschayes'
            WHEN LOWER(player) = 'derrick jones' THEN 'derrickjonesjr'
            WHEN LOWER(player) = 'danuel house' THEN 'danuelhousejr'
            WHEN LOWER(player) = 'enes kanter' THEN 'enesfreedom'
            WHEN LOWER(player) = 'fat lever' THEN 'lafayettelever'
            WHEN LOWER(player) = 'hidayet turkoglu' THEN 'hedoturkoglu'
            WHEN LOWER(player) = 'iakovos tsakalidis' THEN 'jaketsakalidis'
            WHEN LOWER(player) = 'isaac austin' THEN 'ikeaustin'
            WHEN LOWER(player) = 'ishmael smith' THEN 'ishsmith'
            WHEN LOWER(player) = 'jabari smith sr' THEN 'jabarismith'
            WHEN LOWER(player) = 'james ennis' THEN 'jamesennisiii'
            WHEN LOWER(player) = 'frank mason' THEN 'frankmasoniii'
            WHEN LOWER(player) = 'jose juan barea' THEN 'jjbarea'
            WHEN LOWER(player) = 'glen rice jr' THEN 'glenrice'
            WHEN LOWER(player) = 'harry giles' THEN 'harrygilesiii'
            WHEN LOWER(player) = 'johnny o''bryant' THEN 'johnnyobryantiii'
            WHEN LOWER(player) = 'joseph young' THEN 'michaelyoung'
            WHEN LOWER(player) = 'juan hernangomez' THEN 'juanchohernangomez'
            WHEN LOWER(player) = 'joseph young' THEN 'michaelyoung'
            WHEN LOWER(player) = 'wendell carter' THEN 'wendellcarterjr'
            WHEN LOWER(player) = 'troy brown' THEN 'troybrownjr'
            WHEN LOWER(player) = 'timothe luwawu' THEN 'timotheluwawucabarrot'
            WHEN LOWER(player) = 'sviatoslav mykhailiuk' THEN 'svimykhailiuk'
            WHEN LOWER(player) = 'steve smith' THEN 'stevensmith'
            WHEN LOWER(player) = 'stanislav medvedenko' THEN 'slavamedvedenko'
            WHEN LOWER(player) = 'ron grandison' THEN 'ronniegrandison'
            WHEN LOWER(player) = 'ronald murray' THEN 'flipmurray'
            WHEN LOWER(player) = 'roger mason' THEN 'rogermasonjr'
            WHEN LOWER(player) = 'robert williams' THEN 'bobwilliams'
            WHEN LOWER(player) = 'reggie bullock' THEN 'reggiewilliams'
            WHEN LOWER(player) = 'radoslav nesterovic' THEN 'rashonesterovic'
            WHEN LOWER(player) = 'predrag stojakovic' THEN 'pejastojakovic'
            WHEN LOWER(player) = 'perry jones' THEN 'perryjonesiii'
            WHEN LOWER(player) = 'patrick mills' THEN 'pattymills'
            WHEN LOWER(player) = 'otto porter' THEN 'ottoporterjr'
            WHEN LOWER(player) = 'nicolas claxton' THEN 'nicclaxton'
            WHEN LOWER(player) = 'louis williams' THEN 'louwilliams'
            when lower(player) = 'marcus morris' then 'marcusmorrissr'
            when lower(player) = 'marvin bagley' then 'marvinbagleyiii'
            when lower(player) = 'maurice williams' then 'mowilliams'
            when lower(player) = 'troy brown' then 'troybrownjr'
            when lower(player) = 'mike sweetney' then 'michaelsweetney'
            when lower(player) = 'moe harkless' then 'mauriceharkless'
            when lower(player) = 'nenê' then 'nene'
            when lower(player) = 'saer sene' then 'mouhamedsene'
            when lower(player) = 'sergey monya' then 'sergeimonia'
            when lower(player) = 'vernon carey' then 'vernoncareyjr'
            when lower(player) = 'wade baldwin' then 'wadebaldwiniv'
            when lower(player) = 'wesley iwundu' then 'wesiwundu'
            when lower(player) = 'andrew white' then 'andrewwhiteiii'
            when lower(player) = 'anthony barber' then 'catbarber'
            when lower(player) = 'zach auguste' then ''
            when lower(player) = 'yakuba ouattara' then ''
            when lower(player) = 'willie solomon' then 'willsolomon'
            when lower(player) = 'wendell moore' then 'wendellmoorejr'
            when lower(player) = 'walter tavares' then 'edytavares'
            when lower(player) = 'walter lemon jr' then 'waltlemonjr'
            when lower(player) = 'vyacheslav kravtsov' then 'viacheslavkravtsov'
            when lower(player) = 'vj beachem' then ''
            when lower(player) = 'virginijus praskevicius' then ''
            when lower(player) = 'vincent grier' then ''
            when lower(player) = 'vince hunter' then 'vincenthunter'
            when lower(player) = 'tyty washington' then 'tytywashingtonjr'
            when lower(player) = 'tyrone grant' then ''
            when lower(player) = 'trey murphy' then 'treymurphyiii'
            when lower(player) = 'tre scott' then 'trevonscott'
            when lower(player) = 'tommy smith' then ''
            when lower(player) = 'todd lindeman' then ''
            when lower(player) = 'thomas walkup' then ''
            when lower(player) = 'sun yue' then 'sunsun'
            when lower(player) = 'steve bardo' then 'stephenbardo'
            when lower(player) = 'stephan hicks' then ''
            when lower(player) = 'stefan jankovic' then ''
            when lower(player) = 'shannon smith' then ''
            when lower(player) = 'serge zwikker' then ''
            when lower(player) = 'sean chris smith' then ''
            when lower(player) = 'sean banks' then ''
            when lower(player) = 'scott wood' then ''
            when lower(player) = 'scottie wilbekin' then ''
            when lower(player) = 'scottie pippen jr' then 'scottypippenjr'
            when lower(player) = 'santiago aldama' then 'santialdama'
            when lower(player) = 'sam clancy' then ''
            when lower(player) = 'romain sato' then ''
            when lower(player) = 'rodney zimmerman' then ''
            when lower(player) = 'rodney dent' then ''
            when lower(player) = 'robert woodard' then 'robertwoodardii'
            when lower(player) = 'rj nembhard' then 'rjnembhardjr'
            when lower(player) = 'rich manning' then 'richardmanning'
            when lower(player) = 'richard solomon' then ''
            when lower(player) = 'richard hendrix' then ''
            when lower(player) = 'reggie fox' then ''
            when lower(player) = 'raymond spalding' then 'rayspalding'
            when lower(player) = 'raiquan gray' then ''
            when lower(player) = 'rade zagorac' then ''
            when lower(player) = 'quincy ford' then ''
            when lower(player) = 'prince ibeh' then ''
            when lower(player) = 'pete mickeal' then ''
            when lower(player) = 'paul rogers' then ''
            when lower(player) = 'paul miller' then ''
            when lower(player) = 'patric young' then ''
            when lower(player) = 'patrick savoy' then ''
            when lower(player) = 'patrick baldwin' then 'patrickbaldwinjr'
            when lower(player) = 'pat carroll' then ''
            when lower(player) = 'norm richardson' then 'normanrichardson'
            when lower(player) = 'nikola jovanovic' then ''
            when lower(player) = 'nikita morgunov' then ''
            when lower(player) = 'nick zeisloft' then ''
            when lower(player) = 'naz long' then 'nazmitroulong'
            when lower(player) = 'nate higgs' then ''
            when lower(player) = 'mitch creek' then 'mitchellcreek'
            when lower(player) = 'mike holton' then 'michaelholton'
            when lower(player) = 'mike gansey' then ''
            when lower(player) = 'troy brown' then 'troybrownjr'
            when lower(player) = 'micheal eric' then ''
            when lower(player) = 'michael porter' then 'michaelporterjr'
            when lower(player) = 'michael frazier' then 'michaelfrazierii'
            when lower(player) = 'michael foster' then 'michaelfosterjr'
            when lower(player) = 'melvin robinson' then ''
            when lower(player) = 'melvin frazier' then 'melvinfrazierjr'
            when lower(player) = 'mckinley wright' then 'mckinleywrightiv'
            when lower(player) = 'matt williams' then 'mattwilliamsjr'
            when lower(player) = 'matt janning' then ''
            when lower(player) = 'mate skelin' then ''
            when lower(player) = 'mark karcher' then ''
            when lower(player) = 'mark hughes' then ''
            when lower(player) = 'marcus thornton ii' then 'marcusthornton'
            when lower(player) = 'malik ellison' then ''
            when lower(player) = 'malcolm huckaby' then ''
            when lower(player) = 'louis bullock' then ''
            when lower(player) = 'louis amundson' then 'louamundson'
            when lower(player) = 'lonnie walker' then 'lonniewalkeriv'
            when lower(player) = 'logan vander velden' then 'logvandervelden'
            when lower(player) = 'livio jean-charles' then ''
            when lower(player) = 'landry nnoko' then ''
            when lower(player) = 'lamarcus golden' then ''
            when lower(player) = 'kira lewis' then 'kiralewisjr'
            when lower(player) = 'kevin rankin' then ''
            when lower(player) = 'kevin pittsnogle' then ''
            when lower(player) = 'kevin knox' then 'kevinknoxii'
            when lower(player) = 'kenneth lofton' then 'kennethloftonjr'
            when lower(player) = 'kelly oubre' then 'kellyoubrejr'
            when lower(player) = 'keenan evans' then ''
            when lower(player) = 'keaton wallace' then ''
            when lower(player) = 'kareem townes' then ''
            when lower(player) = 'kaleb tarczewski' then ''
            when lower(player) = 'justin tillman' then ''
            when lower(player) = 'justin minaya' then ''
            when lower(player) = 'justin bibbs' then ''
            when lower(player) = 'jp tokoto' then ''
            when lower(player) = 'josh primo' then 'joshuaprimo'
            when lower(player) = 'josh moore' then ''
            when lower(player) = 'jon stefansson' then ''
            when lower(player) = 'jonathan holmes' then ''
            when lower(player) = 'john butler' then 'johnbutlerjr'
            when lower(player) = 'jimmie hunter' then ''
            when lower(player) = 'jermaine walker' then ''
            when lower(player) = 'jeffrey sheppard' then 'jeffsheppard'
            when lower(player) = 'jeff dowtin' then 'jeffdowtinjr'
            when lower(player) = 'jeenathan williams' then ''
            when lower(player) = 'jaylen johnson' then ''
            when lower(player) = 'james webb' then 'jameswebbiii'
            when lower(player) = 'jacob gilyard' then ''
            when lower(player) = 'ishmail wainright' then 'ishwainright'
            when lower(player) = 'isaiah cousins' then ''
            when lower(player) = 'ibo kutluay' then 'ibrahimkutluay'
            when lower(player) = 'horacio llamas grey' then 'horaciollamas'
            when lower(player) = 'herb jones' then 'herbertjones'
            when lower(player) = 'ha seung-jin' then 'haha'
            when lower(player) = 'greg brown' then 'gregbrowniii'
            when lower(player) = 'grady livingston' then ''
            when lower(player) = 'frederic weis' then ''
            when lower(player) = 'eric griffin' then ''
            when lower(player) = 'elgin cook' then ''
            when lower(player) = 'ej singler' then ''
            when lower(player) = 'egidijus mockevicius' then ''
            when lower(player) = 'dj steward' then ''
            when lower(player) = 'didier ilunga-mbenga' then 'djmbenga'
            when lower(player) = 'derrick walton' then 'derrickwaltonjr'
            when lower(player) = 'derrick alston sr' then 'derrickalston'
            when lower(player) = 'david duke' then 'daviddukejr'
            when lower(player) = 'dave greenwood' then 'davidgreenwood'
            when lower(player) = 'daulton hommes' then ''
            when lower(player) = 'daniel horton' then ''
            when lower(player) = 'damon bailey' then ''
            when lower(player) = 'curtis blair' then ''
            when lower(player) = 'constantin popa' then ''
            when lower(player) = 'cody demps' then ''
            when lower(player) = 'cliff robinson' then 'cliffordrobinson'
            when lower(player) = 'cj fair' then ''
            when lower(player) = 'christapher johnson' then 'chrisjohnson'
            when lower(player) = 'chris carrawell' then ''
            when lower(player) = 'chaundee brown' then 'chaundeebrownjr'
            when lower(player) = 'charlie brown' then 'charliebrownjr'
            when lower(player) = 'carlos strong' then ''
            when lower(player) = 'bronson koenig' then ''
            when lower(player) = 'brian chase' then ''
            when lower(player) = 'brian bowen' then ''
            when lower(player) = 'brett robisch' then ''
            when lower(player) = 'brandon wallace' then ''
            when lower(player) = 'brady heslip' then ''
            when lower(player) = 'bj boston' then 'brandonbostonjr'
            when lower(player) = 'billy preston' then ''
            when lower(player) = 'beau beech' then ''
            when lower(player) = 'bakari hendrix' then ''
            when lower(player) = 'arthur johnson' then ''
            when lower(player) = 'aric holman' then ''
            when lower(player) = 'anthony barber' then 'catbarber'
            when lower(player) = 'alan bannister' then ''
            when lower(player) = 'adrian custis' then ''
            when lower(player) = 'ademola okulaja' then ''
            when lower(player) = 'adam haluska' then ''
            ELSE TRANSLATE(REGEXP_REPLACE(LOWER(player), '[^a-zA-Z]', ''), 'ČĆĐŠŽčćđšž', 'CCDZZccdzz')
        END AS ps_regex_player_name,
        salary, 
        player,
        season
    FROM 
        {{ ref('source_player_salaries') }}
), 
common_player_info as (
    select 
        player_id,
        full_name,
        TRANSLATE(REGEXP_REPLACE(LOWER(full_name), '[^a-zA-Z]', ''), 'ČĆĐŠŽčćđšž', 'CCDZZccdzz') as cpi_regex_player_name
    from 
        {{ ref('source_common_player_info') }}
),

joined as (
    select 
        cpi.player_id,
        cpi.full_name as player_name,
        ps.salary,
        ps.season
    from 
        player_salaries ps
    left join common_player_info cpi
        ON ps.ps_regex_player_name = cpi.cpi_regex_player_name
)
select 
    * 
from 
    joined
